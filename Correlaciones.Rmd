---
title: "Calculo_Correlación"
author: "DiCaBHe"
date: "28/10/2020"
output: html_document
---

En este capítulo realizaremos un análisis de las correlaciones entre las variables que nos ayudarán a decidir que variables pueden ser las mejores candidatas para nuestro modelo.

```{r echo=FALSE,  warning=FALSE, message=FALSE}
#Cargar paquetes
library(readxl)
library(dplyr)
library(ggplot2)
library(Hmisc)
library(corrplot)
library(PerformanceAnalytics)
```

La base de datos que utilizaremos es `base_modelado` la misma que visualizamos en la página 15

```{r message=FALSE}
head(base_modelado)
```
Para el análisis de correlaciones, se toman las variables macroeconómicas (PIB, Inflación, Desempleo, GNC, Balance de cuenta corriente y TRM), compra y venta de metales preciosos y se compara con la variable objetivo.

```{r echo=FALSE}
#A continuación se agrupan las variables de interés en un nuevo dataframe

base = base_modelado[,19:34]
base['Var.objetivo']= base_modelado[35]
#head(base)
```

### Calcular el coeficiente de correlación
Este comando calcula la matriz de correlación:
```{r echo=FALSE}
round(cor(base),2)  
```

Con el resultado de la correlación, podemos interpretar que las variables macroeconomicas, compra y venta de metales preciosos no explican la variable objetivo, ya que el nivel de significancia es
cercano a cero. Es decir, no encontramos una ascociación entre estas variables y la variable objetivo, que nos ayude a predecir o explicar el comportamiento de los costos y gastos totales de las empresas del sector "extracción de oro y otros metales preciosos".

### Visualizar matriz de correlación
Utilizaremos el comando corrplot para visualizar la matriz de correlaciones. Lo primero es calcular la matriz, guardarla en un objeto y luego graficarla. En este caso vamos a graficar los coeficientes resultantes.

```{r}
correlacion<-round(cor(base), 1)

corrplot(correlacion, method="number", type="upper")
```
Se realizó el análisis de correlación con el estadístico de Pearson, con las variables originales y estandarizadas, con el fin de evidenciar las variables explicativas de la variable objetivo construida, encontrando como resultado la no significancia para explicar el comportamiento de
los costos y gastos del sector que estamos estudiando.

A continuación se grafican los datos de la Variable objetivo (costos y gastos totales) con respecto a var.PIB (Variación del PIB)

```{r warning=FALSE, message=FALSE}
ggplot(base, aes(x=Var.PIB, y=Var.objetivo)) +geom_point()+scale_y_log10()

```
Podemos apreciar que no se presenta un comportamiento lineal entre las variables, por lo tanto la variable PIB no es una buena candidata para utilizar en nuestro modelo. De forma general encontramos que las macroeconómicas no explican la variable objetivo.
Por tal motivo se decide no trabajar con las variables macroeconomicas venta y compra de metales preciosos en los modelos.


