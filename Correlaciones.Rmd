---
title: "Calculo_Correlación"
author: "DiCaBHe"
date: "28/10/2020"
output: html_document
---


```{r echo=FALSE}
#Cargar paquetes
library(readxl)
library(dplyr)
library(ggplot2)
library(Hmisc)
library(corrplot)
library(PerformanceAnalytics)
```

Se presenta la base de datos

```{r}
head(base_modelado)
```
Para el análisis de correlaciones se toman las variables macroeconomicas (PIB, Inflación, Desempleo, GNC, Balance de cuenta corriente y TIM) y se comparan respecto a los costos de ventas.

```{r}
#A continuación se agrupan las variables de interés en un nuevo dataframe

base = base_modelado[,19:28]
base['Var.objetivo']= base_modelado[29]
head(base)
```

#Calcular el coeficiente de correlación
Este comando calcula la matriz de correlación:
```{r}
round(cor(base),2)  
```

Podemos interpretar que, la correlación entre las varianbles macroeconomicas y la variable objetivo no son explicativas, si nivel de significancia es cercano a cero. Es decir, no hay una ascociación entre estas variables y la variable objetivo, que nos ayude a predecir o explicar el comportamiento de los costos y gastos totales.


#Ver la matriz de forma gráfica
Podemos graficar con el comando corrplot. Ver más en este enlace:
Lo primero es calcular la matriz de correlación y guardarla en un objeto y luego graficarlo. En este caso vamos a graficar los coeficientes.

```{r}
correlacion<-round(cor(base), 1)

corrplot(correlacion, method="number", type="upper")
```
A continuación se grafican los datos de la Variable objetivo (costos y gastos totales) con respecto a var.PIB (Variación del PIB)

```{r}
ggplot(base, aes(x=Var.PIB, y=Var.objetivo)) +geom_point()+scale_y_log10()

```
Podemos apreciar que no se presenta un comportamiento lineal entre las variables. Por tal motivo se decide no trabajar con las variables macroeconomicas en los modelos.


















